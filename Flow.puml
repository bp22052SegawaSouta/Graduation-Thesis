@startuml AI Agent State Diagram

title AIエージェントの状態遷移図

[*] --> 起動中 : 起動

state 起動中 {
    [*] --> モデリング知識の導入
}

起動中 --> 待機中 : モデリング知識の導入完了


state 待機中 {
    [*] --> ドメイン知識入力待ち
    ドメイン知識入力待ち --> ドメイン知識導入 : ユーザーがドメイン知識を入力
    ドメイン知識導入 --> 解析指示待ち : RAGによる知識導入完了
    解析指示待ち --> タスク分解 : ユーザーが解析開始を指示
}

タスク分解 --> モデリング実行 : 分解プラン生成完了
モデリング実行 --> セルフリフレクション : 初期モデル生成

state セルフリフレクション {
    [*] --> モデルチェック
    モデルチェック --> モデル改善 : [改善点あり (ループ < 3回)]
    モデル改善 --> モデルチェック
    モデルチェック --> モデル改善完了 : [改善点なし or ループ = 3回]
}

セルフリフレクション --> モデル表示 : モデル改善完了

state モデル表示 {
    [*] --> フィードバック待ち
    フィードバック待ち --> モデリング実行 : ユーザーが修正を指示
    フィードバック待ち --> 完了 : ユーザーがモデルを承認
}

完了 --> [*]

@enduml
